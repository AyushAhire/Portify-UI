export default function GenerateReport(
    optimizedData,
    backtestData
) { 
    const op = {
            "equal_weights_results": {
                "portfolio_variance": 0.04899694544253433,
                "portfolio_volatility": 0.22135253656223217,
                "portfolio_annual_return": 0.30354937500260015,
                "percent_var": "5.0%",
                "percent_vols": "22.0%",
                "percent_ret": "30.0%"
            },
            "optimized_results": {
                "performance": {
                    "expected_returns": 1.7148330878360358,
                    "volatility": 0.3067593936424219,
                    "sharpe_ratio": 5.524959049213796
                },
                "weights": {
                    "APARINDS": 5.834000000000001,
                    "BHEL": 2.8480000000000003,
                    "FACT": 5.167000000000001,
                    "IOB": 2.5300000000000002,
                    "IRB": 1.2060000000000002,
                    "JBMA": 13.591000000000003,
                    "JINDALSAW": 5.604000000000001,
                    "MRPL": 19.114000000000004,
                    "NBCC": 13.265000000000002,
                    "OLECTRA": 7.067000000000001,
                    "SUZLON": 15.540000000000004,
                    "SWANENERGY": 8.207000000000003,
                    "UCOBANK": 0.027000000000000007
                },
                "invested": {
                    "APARINDS": {
                        "price": 6296.7998046875,
                        "units": 1,
                        "allocated": 6296.7998046875
                    },
                    "BHEL": {
                        "price": 229.6000061035156,
                        "units": 13,
                        "allocated": 2984.8000793457027
                    },
                    "FACT": {
                        "price": 792.2999877929688,
                        "units": 7,
                        "allocated": 5546.099914550781
                    },
                    "IOB": {
                        "price": 67.5,
                        "units": 38,
                        "allocated": 2565
                    },
                    "IRB": {
                        "price": 66.55000305175781,
                        "units": 18,
                        "allocated": 1197.9000549316406
                    },
                    "JBMA": {
                        "price": 2204.949951171875,
                        "units": 6,
                        "allocated": 13229.69970703125
                    },
                    "JINDALSAW": {
                        "price": 528.6500244140625,
                        "units": 11,
                        "allocated": 5815.1502685546875
                    },
                    "MRPL": {
                        "price": 245.8500061035156,
                        "units": 78,
                        "allocated": 19176.300476074215
                    },
                    "NBCC": {
                        "price": 143.39999389648438,
                        "units": 93,
                        "allocated": 13336.199432373047
                    },
                    "OLECTRA": {
                        "price": 2034.199951171875,
                        "units": 3,
                        "allocated": 6102.599853515625
                    },
                    "SUZLON": {
                        "price": 44.900001525878906,
                        "units": 347,
                        "allocated": 15580.30052947998
                    },
                    "SWANENERGY": {
                        "price": 736.5,
                        "units": 11,
                        "allocated": 8101.5
                    },
                    "UCOBANK": {
                        "price": 59.20000076293945,
                        "units": 1,
                        "allocated": 59.20000076293945
                    }
                },
                "remaining": 8.44987043934816,
                "sector_allocation": {
                    "APARINDS": "Capital Goods",
                    "BHEL": "Capital Goods",
                    "FACT": "Chemicals",
                    "IRB": "Construction",
                    "IOB": "Financial Services",
                    "JBMA": "Automobile and Auto Components",
                    "JINDALSAW": "Capital Goods",
                    "MRPL": "Oil, Gas & Consumable Fuels",
                    "NBCC": "Construction",
                    "OLECTRA": "Automobile and Auto Components",
                    "SUZLON": "Capital Goods",
                    "SWANENERGY": "Realty",
                    "UCOBANK": "Financial Services"
                }
            },
            "start_date": "2024-02-23"
        }

    const bt = {
            "equal_weights_results": {
                "Date": {
                    "0": "2021-03-26",
                    "1": "2021-04-27",
                    "2": "2021-05-27",
                    "3": "2021-06-25",
                    "4": "2021-07-26",
                    "5": "2021-08-25",
                    "6": "2021-09-24",
                    "7": "2021-10-22",
                    "8": "2021-11-23",
                    "9": "2021-12-23",
                    "10": "2022-01-21",
                    "11": "2022-02-21",
                    "12": "2022-03-23",
                    "13": "2022-04-22",
                    "14": "2022-05-20",
                    "15": "2022-06-21",
                    "16": "2022-07-21",
                    "17": "2022-08-19",
                    "18": "2022-09-19",
                    "19": "2022-10-19",
                    "20": "2022-11-18",
                    "21": "2022-12-16",
                    "22": "2023-01-17",
                    "23": "2023-02-16",
                    "24": "2023-03-17",
                    "25": "2023-04-17",
                    "26": "2023-05-17",
                    "27": "2023-06-16",
                    "28": "2023-07-14",
                    "29": "2023-08-15",
                    "30": "2023-09-14",
                    "31": "2023-10-13",
                    "32": "2023-11-13",
                    "33": "2023-12-13",
                    "34": "2024-01-12",
                    "35": "2024-02-09"
                },
                "PctChange": {
                    "0": -2.4541682273086276,
                    "1": -2.255965959201327,
                    "2": 17.075685179209238,
                    "3": 13.913740867242403,
                    "4": -1.8803172848571421,
                    "5": -9.08323492262765,
                    "6": 6.436762777541991,
                    "7": 14.84552043305363,
                    "8": 0.016026873709048928,
                    "9": 1.222854760358067,
                    "10": 11.780362899975168,
                    "11": -6.858854100266812,
                    "12": -2.936054497575736,
                    "13": 16.888732928681836,
                    "14": -6.305006000480233,
                    "15": -11.929579213430323,
                    "16": 5.786331883656154,
                    "17": 3.0613531612294085,
                    "18": 3.552951239370804,
                    "19": -0.5353066437817285,
                    "20": 6.163260204514458,
                    "21": 32.723970838808484,
                    "22": 0.210955329242655,
                    "23": -7.748557387665675,
                    "24": -1.2453947604259652,
                    "25": 11.589791030125047,
                    "26": 4.265193526101835,
                    "27": 13.743560310652189,
                    "28": 19.645868758006337,
                    "29": 0.1587561890171814,
                    "30": 17.33713849195976,
                    "31": 3.771369478608909,
                    "32": 9.544400110140625,
                    "33": 6.548258730097749,
                    "34": 14.2125335418366,
                    "35": 22.249895877159553
                },
                "niftyPctChange": {
                    "0": -0.15039135358939631,
                    "1": -1.2936915867254701,
                    "2": 4.673428493148457,
                    "3": 3.4066053150021154,
                    "4": 0.06165150068978174,
                    "5": 5.119926350126821,
                    "6": 7.3253648228865265,
                    "7": 1.4658502863741814,
                    "8": -3.4319284972691877,
                    "9": -2.460957528776579,
                    "10": 3.189618416113814,
                    "11": 0.3355906873299539,
                    "12": 0.22665654915176897,
                    "13": -0.42736092989027014,
                    "14": -5.274874835618317,
                    "15": -3.5517177850225483,
                    "16": 6.179823307302781,
                    "17": 6.944786852049803,
                    "18": 0.7521184808265285,
                    "19": -0.6242108697811005,
                    "20": 4.541965713286414,
                    "21": -0.21111606241285955,
                    "22": -1.9931568070896073,
                    "23": -0.09666471570187671,
                    "24": -5.188548631712773,
                    "25": 4.229057487640062,
                    "26": 2.682015158549498,
                    "27": 3.543388287706079,
                    "28": 3.9227663869117175,
                    "29": -1.4047594087430548,
                    "30": 3.2781896191882867,
                    "31": -1.7512166529823263,
                    "32": -1.4605862062412103,
                    "33": 7.6261730421940594,
                    "34": 4.626708384157197,
                    "35": -0.5117747441795324
                }
            },
            "optimized_results": {
                "Date": {
                    "0": "2021-03-26",
                    "1": "2021-04-27",
                    "2": "2021-05-27",
                    "3": "2021-06-25",
                    "4": "2021-07-26",
                    "5": "2021-08-25",
                    "6": "2021-09-24",
                    "7": "2021-10-22",
                    "8": "2021-11-23",
                    "9": "2021-12-23",
                    "10": "2022-01-21",
                    "11": "2022-02-21",
                    "12": "2022-03-23",
                    "13": "2022-04-22",
                    "14": "2022-05-20",
                    "15": "2022-06-21",
                    "16": "2022-07-21",
                    "17": "2022-08-19",
                    "18": "2022-09-19",
                    "19": "2022-10-19",
                    "20": "2022-11-18",
                    "21": "2022-12-16",
                    "22": "2023-01-17",
                    "23": "2023-02-16",
                    "24": "2023-03-17",
                    "25": "2023-04-17",
                    "26": "2023-05-17",
                    "27": "2023-06-16",
                    "28": "2023-07-14",
                    "29": "2023-08-15",
                    "30": "2023-09-14",
                    "31": "2023-10-13",
                    "32": "2023-11-13",
                    "33": "2023-12-13",
                    "34": "2024-01-12",
                    "35": "2024-02-09"
                },
                "PctChange": {
                    "0": 0.2669616829225033,
                    "1": -4.58561807685673,
                    "2": 19.22870969533274,
                    "3": 10.636113307716046,
                    "4": -3.7164474248074995,
                    "5": -8.715040914347858,
                    "6": 5.666962293171294,
                    "7": 9.45038554735045,
                    "8": 2.3273744381170722,
                    "9": 2.6896192772625316,
                    "10": 17.763385364764044,
                    "11": -9.336683387624568,
                    "12": -2.487236685447689,
                    "13": 25.199691158406072,
                    "14": -3.2461464862545064,
                    "15": -11.418231137882202,
                    "16": 1.1705235297319465,
                    "17": 0.9319382387810559,
                    "18": 3.111107049017166,
                    "19": -2.7588792701635367,
                    "20": 1.6132049829922956,
                    "21": 19.453689454652352,
                    "22": 0.3141408385658294,
                    "23": -6.087980884954935,
                    "24": 1.558009789630865,
                    "25": 10.618553231249535,
                    "26": 6.135194967113183,
                    "27": 20.51335858955782,
                    "28": 23.53798506696392,
                    "29": 0.30630428043112656,
                    "30": 15.430774572437715,
                    "31": 3.1245445952808057,
                    "32": 13.529006247426143,
                    "33": 6.268115984328125,
                    "34": 18.022190094542303,
                    "35": 18.252236772984737
                },
                "niftyPctChange": {
                    "0": -0.15039135358939631,
                    "1": -1.2936915867254701,
                    "2": 4.673428493148457,
                    "3": 3.4066053150021154,
                    "4": 0.06165150068978174,
                    "5": 5.119926350126821,
                    "6": 7.3253648228865265,
                    "7": 1.4658502863741814,
                    "8": -3.4319284972691877,
                    "9": -2.460957528776579,
                    "10": 3.189618416113814,
                    "11": 0.3355906873299539,
                    "12": 0.22665654915176897,
                    "13": -0.42736092989027014,
                    "14": -5.274874835618317,
                    "15": -3.5517177850225483,
                    "16": 6.179823307302781,
                    "17": 6.944786852049803,
                    "18": 0.7521184808265285,
                    "19": -0.6242108697811005,
                    "20": 4.541965713286414,
                    "21": -0.21111606241285955,
                    "22": -1.9931568070896073,
                    "23": -0.09666471570187671,
                    "24": -5.188548631712773,
                    "25": 4.229057487640062,
                    "26": 2.682015158549498,
                    "27": 3.543388287706079,
                    "28": 3.9227663869117175,
                    "29": -1.4047594087430548,
                    "30": 3.2781896191882867,
                    "31": -1.7512166529823263,
                    "32": -1.4605862062412103,
                    "33": 7.6261730421940594,
                    "34": 4.626708384157197,
                    "35": -0.5117747441795324
                }
            },
            "start_date": "2024-02-23"
    }


    // generate a csv file for optimized results
    let InvestedCsv = "data:text/csv;charset=utf-8,";
    InvestedCsv += "Stock,Price,Units,Allocated,Weight,Sector\n";
    Object.keys(op.optimized_results.invested).map((key, index) => {
        InvestedCsv += `${key},${op.optimized_results.invested[key].price.toFixed(2)},${op.optimized_results.invested[key].units},${op.optimized_results.invested[key].allocated.toFixed(2)},${(op.optimized_results.weights[key]).toFixed(2)}%,${op.optimized_results.sector_allocation[key]}\n`
    })

    // generate a csv file for backtest results
    let BacktestCsv = "data:text/csv;charset=utf-8,";
    BacktestCsv += "Date,ptc_change_optimized,ptc_change_Equal,ptc_change_Nifty\n";
    Object.keys(bt.optimized_results.Date).map((key, index) => {
        BacktestCsv += `${bt.optimized_results.Date[key]},${bt.optimized_results.PctChange[key]},${bt.equal_weights_results.PctChange[key]},${bt.equal_weights_results.niftyPctChange[key]}\n`
    })

    // create a link to download the csv files
    const InvestedCsvLink = encodeURI(InvestedCsv);
    const BacktestCsvLink = encodeURI(BacktestCsv);
    const InvestedCsvLinkElement = document.createElement('a');
    InvestedCsvLinkElement.setAttribute('href', InvestedCsvLink);
    InvestedCsvLinkElement.setAttribute('download', 'Invested.csv');
    InvestedCsvLinkElement.click();
    const BacktestCsvLinkElement = document.createElement('a');
    BacktestCsvLinkElement.setAttribute('href', BacktestCsvLink);
    BacktestCsvLinkElement.setAttribute('download', 'Backtest.csv');
    BacktestCsvLinkElement.click();

}